
'use client';

import React, { useState } from 'react';
import { motion } from 'framer-motion';
import { useTheme } from '@/contexts/theme-context';

const AnimatedLogo = ({
                          width = "300px",
                          height = "300px",
                          colors = null, // Will use theme-based colors if not provided
                          speed = 5 // Duration in seconds per color switch
                      }) => {
    const { theme } = useTheme();

    // Use provided colors or default to theme-aware colors
    const defaultColors = theme === 'dark'
        ? ["#fff", "#0099ff", "#ff0055"]
        : ["#000", "#66ccff", "#ff6699"];

    const activeColors = colors || defaultColors;

    // 1. Paste your SVG data here
    // 1. Your Original Logo Shape (Cleaned up)
    const logoShape = `
    M 283.50709,241.60488
    c 2.99981,-1.48469 5.70331,-3.80051 8.45688,-3.86188 4.63647,-0.10337 6.05793,-2.85495 7.95218,-6.12445 10.70851,-18.48304 21.52287,-36.90601 32.50011,-55.22982 1.72024,-2.87144 2.02635,-4.65885 -0.13586,-7.58793 -2.75522,-3.73251 -4.47552,-8.2317 -7.00085,-13.09101 -15.2067,0 -31.22318,-0.13965 -47.23055,0.17896 -1.97276,0.0393 -4.50729,2.11159 -5.74071,3.94465 -6.1316,9.1125 -12.01428,18.40031 -17.67109,27.81541 -0.58646,0.97614 0.42584,3.66347 1.5018,4.77245 6.48712,6.6862 7.77583,14.6947 4.86421,22.93394 -4.40884,12.47588 -18.50789,16.28719 -29.98121,8.72788 -8.44487,-5.56401 -12.7002,-16.55387 -9.78741,-26.13826 2.45954,-8.09295 8.19572,-12.5097 16.47767,-14.00544 1.613,-0.29131 3.48749,-1.591 4.38867,-2.98058 6.22797,-9.60344 12.13566,-19.41497 18.33598,-29.03692 4.55069,-7.06197 11.19807,-10.53659 19.62309,-10.54304 14.05296,-0.0108 28.10831,-0.18323 42.1572,0.0464 3.57967,0.0585 5.43379,-1.03163 7.00025,-4.20517 8.97429,-18.18141 28.2062,-19.64861 39.55453,-14.21489 11.39056,5.45395 17.80461,18.31509 15.95576,32.17161 -1.75054,13.11968 -11.08683,23.24825 -23.54009,25.38096 -1.93235,0.33095 -4.19557,0.75635 -5.88661,0.0825 -4.8482,-1.93217 -6.52557,0.84079 -8.60962,4.41325 -10.91808,18.7157 -21.9966,37.33882 -33.20096,55.88398 -1.47295,2.43797 -1.74041,4.08508 -0.17048,6.55189 4.13494,6.4972 4.74088,13.44349 1.52262,20.5538 -2.72859,6.02855 -7.30987,9.85498 -13.96551,10.36893 -3.98703,0.30787 -6.2448,2.07588 -8.08878,5.51169 -11.61196,21.63576 -23.5373,43.10343 -35.06264,64.78484 -7.20856,13.56073 -18.76239,19.4626 -31.89509,15.57205 -6.86825,-2.03472 -11.29118,-6.83169 -14.86718,-12.79932
    C 187.59419,312.48255 164.14309,273.53307 140.73569,234.55728 119.76693,199.6421 98.818934,164.71442 77.868901,129.78795
    c -0.544881,-0.9084 -1.006874,-1.8667 -1.846003,-3.43388 1.833447,-0.14944 3.259145,-0.36174 4.68564,-0.36727 17.10777,-0.0663 34.221822,0.16023 51.321192,-0.24363 10.31304,-0.24357 17.47654,4.19344 22.69722,12.65475 8.33513,13.50899 16.71281,26.99158 25.04451,40.50266 18.66344,30.26545 37.24338,60.58302 56.0523,90.75738 2.18834,3.51069 2.21872,6.07381 0.0658,9.47182 -3.41524,5.39053 -6.34877,11.08733 -9.99657,17.56036 -2.4558,-3.85687 -4.49135,-6.9533 -6.42814,-10.11055 -26.72254,-43.56134 -53.44486,-87.12284 -80.11595,-130.71581 -1.9376,-3.16694 -4.31952,-4.85207 -8.18204,-4.62881 -4.21827,0.24384 -8.46145,0.0555 -13.67572,0.0555 3.48454,5.87732 6.53589,11.05312 9.61472,16.21246 30.25723,50.70345 60.52204,101.40234 90.77289,152.10959 2.03127,3.40487 3.73202,7.03176 5.99478,10.26895 5.13274,7.34305 14.83579,7.29256 19.44493,-0.36515 11.79632,-19.59864 23.31684,-39.36471 34.79487,-59.15275 0.67563,-1.1648 0.39981,-3.26036 -0.11093,-4.67776 -3.28601,-9.11933 -1.78329,-17.08934 5.50466,-24.08086
    m 63.52604,-86.05984
    c 3.47223,4.5423 7.04546,5.92981 11.73793,4.56574 4.27813,-1.24362 6.66205,-4.13855 6.9651,-8.53203 0.31188,-4.5215 -1.75444,-7.89898 -5.66624,-10.1069 -3.98167,-2.24738 -7.71305,-1.31186 -10.95654,1.42941 -3.87775,3.27727 -4.08675,7.53102 -2.08025,12.64378
    m -104.93216,40.62287
    c -4.73022,-0.59304 -8.0785,1.28183 -9.61486,5.81338 -1.59933,4.71739 0.42245,9.83459 4.66646,12.26617 3.89075,2.22915 7.63483,1.88232 10.95371,-1.13176 5.58168,-5.06907 2.86076,-13.70039 -6.00531,-16.94779
    m 62.53281,62.81987
    c -0.0475,-4.24811 -1.88589,-7.7417 -5.96402,-8.67815 -2.23463,-0.51312 -5.50486,0.40692 -7.32605,1.8906 -2.86996,2.33799 -3.54767,5.92552 -1.72446,9.54354 1.66919,3.31244 4.39608,5.21467 8.06231,4.81592 3.90984,-0.42526 6.13748,-3.02913 6.95222,-7.57191
    z
  `;

    // 2. Your Drawn "Motion" Path// 2. Paste your NEW Motion Path here
    const motionPath = `
      M 230.4712,284.32696 133.48079,125.51443 78.322121,127.73558 215.6635,355.4039
      l 8.88462,7.40385
      h 8.14423
      l 9.25481,-1.85096 9.25481,-5.92308 5.18269,-6.29327 -7.77404,-9.25481 44.0529,-74.03848 63.3029,-114.75964 19.62019,-21.47116 -25.54327,19.25 -74.77887,0.74039 -6.29327,3.33173 -24.43269,42.20193 -4.07212,11.10578 -8.14423,17.39904 -0.77081,1.16726
    `;

    // State to track the current color cycle
    const [index, setIndex] = useState(0);

    // Determine which colors are active
    const backgroundColor = activeColors[index];
    const foregroundColor = activeColors[(index + 1) % activeColors.length];

    return (
        <div style={{ width: width, height: height }}>
            <svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    {/*
             The Mask
             We use the 'key' prop here. When 'index' changes, React destroys
             and recreates this mask, automatically resetting pathLength to 0.
          */}
                    <mask id="cycle-mask">
                        <motion.path
                            key={index} // Vital: forces the animation to restart on color change
                            d={motionPath}
                            fill="transparent"
                            stroke="white"
                            strokeWidth="60" // Adjust thickness if needed to cover logo
                            strokeLinecap="round"
                            strokeLinejoin="round"
                            initial={{ pathLength: 0 }}
                            animate={{ pathLength: 1 }}
                            transition={{
                                duration: speed,
                                ease: "linear" // Linear usually looks smoother for continuous cycling
                            }}
                            onAnimationComplete={() => {
                                // Move to the next color index when drawing finishes
                                setIndex((prev) => (prev + 1) % activeColors.length);
                            }}
                        />
                    </mask>
                </defs>

                {/* Layer 1: The Base Color (The color we just finished drawing) */}
                <path
                    d={logoShape}
                    fill={backgroundColor}
                    transition={{ duration: 0 }} // Instant switch to prevent flashing
                />

                {/* Layer 2: The Next Color (Being drawn by the mask) */}
                <path
                    d={logoShape}
                    fill={foregroundColor}
                    mask="url(#cycle-mask)"
                />
            </svg>
        </div>
    );
};

export default AnimatedLogo;